<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

</head>

<body>
  <h1>Tweets</h1>
  <form id="searchForm" action="/" method="get">
    <input type="search" name="searchTweet" id="searchInput" placeholder="Buscar no Twitter">
    <br>
    <input type="radio" name="user" id="user" value="user">
    <label for="user">User</label>
    <input type="radio" name="images" id="images" value="has:images">
    <label for="user">Images</label>
    <input type="radio" name="videos" id="videos" value="has:videos">
    <label for="user">Videos</label>
    <br>
    <button type="submit">Buscar</button>
  </form>
  <!-- <button type="button" onclick="getRequest()">Reload</button> -->
  <ul id="twitter-response">
  </ul>
</body>

<script>
  window.onload = function () {
    document.getElementById('searchForm').addEventListener('submit', function (event) {
      event.preventDefault();
      const query = event.target.searchTweet.value
      console.log(event.target.user.value);

      getRequest(query)

    })
  }

  function getRequest(query) {
    const endpoint = query == undefined ? 'http://localhost:3000/tweets' : 'http://localhost:3000/tweets' + '?' + 'searchTweet=' + query
    const xhr = new XMLHttpRequest();

    xhr.open('GET', endpoint);

    xhr.onload = (e) => {

      if (xhr.status === 200 && xhr.response && query != undefined) {
        listTweets(JSON.parse(xhr.response))
      }
    }

    xhr.send();

    function listTweets(tweets) {

      const ul = document.getElementById('twitter-response')
      ul.innerHTML = '';

      for (let x = 0; x < tweets.length; x++) {
        const li = document.createElement('li');
        li.innerText = `${tweets[x].text}`;
        ul.appendChild(li)
      }
    }
  }


  getRequest()

  // setInterval(() => {
  //   getRequest()
  // }, 360000)
</script>

</html>